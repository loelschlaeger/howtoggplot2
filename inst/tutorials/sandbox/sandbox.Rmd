---
title: "Tutorial"
output: 
  learnr::tutorial:
    allow_skip: true
runtime: shiny_prerendered
description: >
  The practical part of the "How to {ggplot2}" course.
---

```{r setup, include=FALSE}
library(learnr)
library(ggplot2)
library(gapminder)
knitr::opts_chunk$set(echo = FALSE)
```

## Part 1: Our first plot

Try to reproduce our scatter plot of the `gapminder` dataset, where we put `gdpPercap` on the x- and `lifeExp` on the y-axis and added a smoothed line.

```{r firstplot, exercise = TRUE}

```

```{r firstplot-solution}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) + 
  geom_point() + 
  geom_smooth()
```

Per default, {ggplot2} uses a generalized additive model to derive the smoothed line, but other options exist. Try adding `method = "lm"` as an argument to `geom_smooth()` to use a linear model instead. Is the linear model adequate?

```{r lm, exercise = TRUE}

```

```{r lm-solution}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) + 
  geom_point() + 
  geom_smooth(method = "lm")
```

Does anything happen if you put the `geom_smooth()` function before the `geom_point()` function?

```{r order, exercise = TRUE}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) + 
  geom_smooth(method = "lm") +
  geom_point()
```

Probably, we could improve the graphic if we transform the x-axis from a linear to a log scale. Do you remember how to do this? Additionally, polish the x-axis format to dollar values.

```{r log, exercise = TRUE}

```

```{r log-solution}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) + 
  geom_point() + 
  geom_smooth(method = "lm") +
  scale_x_log10(scales::dollar)
```

There is another popular aesthetic to map a variable to a color. Try the following and understand what happens:

```{r color, exercise = TRUE}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp, color = continent)) + 
  geom_point()
```

Say we want to ink each point green. Why does the following not work? How to fix it?

```{r green, exercise = TRUE}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp, color = "green")) + 
  geom_point()
```

```{r green-solution}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) + 
  geom_point(color = "green")
```

Consider the following plot. We have a smoothing line for each separate continent. This might be a bit confusing, can you change the code such that we have only one overall smoothing line but still have the points color-coded by continents?

```{r one-smooth, exercise = TRUE}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp, color = continent, fill = continent)) + 
  geom_point() + 
  geom_smooth() +
  scale_x_log10()
```

```{r one-smooth-solution}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) + 
  geom_point(mapping = aes(color = continent)) + 
  geom_smooth() +
  scale_x_log10()
```

```{r quiz}
quiz(
  question("Which of the R packages listed below can we load to access the `ggplot()` function?",
    answer("gapminder"),
    answer("ggplot"),
    answer("ggplot2", correct = TRUE),
    answer("tidyverse", correct = TRUE)
  ),
  question("What is the `aes()` function good for? Telling {ggplot2} ...",
    answer("what data we use."),
    answer("what relationships we want to see.", correct = TRUE),
    answer("the plot type we want to produce."),
    answer("that we want to adjust the x-axis.")
  )
)
```

## Part 2: More aesthetic(s)


